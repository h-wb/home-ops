# Prefect Deployment Configuration
name: pipelines

pull:
- prefect.deployments.steps.git_clone:
    repository: https://github.com/h-wb/pipelines.git
    branch: main
- prefect.deployments.steps.set_working_directory:
    directory: "{{ steps.git-clone.directory }}"
# - prefect.deployments.steps.run_shell_script:
#     id: install-dependencies
#     script: sh -c "cd pipelines-main && uv pip install . && uv sync --frozen"

deployments:
- name: listenbrainz-pipeline
  version: 1.0.0
  tags: ["listenbrainz", "dlt"]
  description: ListenBrainz listening history pipeline
  entrypoint: ./src/pipelines/listenbrainz.py:load_listenbrainz
  work_pool:
    name: local
    work_queue_name: null
  schedule:
    cron: "0 0 * * *"
    timezone: Europe/Paris
